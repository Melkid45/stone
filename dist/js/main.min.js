/**
 * @name		Shuffle Letters
 * @author		Martin Angelov
 * @version 	1.0
 * @url			http://tutorialzine.com/2011/09/shuffle-letters-effect-jquery/
 * @license		MIT License
 */
let scrollTrigger;!function(e){function t(e){var t="";"lowerLetter"==e?t="abcdefghijklmnopqrstuvwxyz0123456789":"upperLetter"==e?t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789":"symbol"==e&&(t=",.?/\\(^)![]{}*&^%$#'\"0123456789");var o=t.split("");return o[Math.floor(Math.random()*o.length)]}e.fn.shuffleLetters=function(o){var r=e.extend({step:4,fps:35,text:"",callback:function(){}},o);return this.each((function(){var o=e(this),i="";if(o.data("animated"))return!0;o.data("animated",!0),i=r.text?r.text.split(""):o.text().split("");for(var n=[],s=[],a=0;a<i.length;a++){var c=i[a];" "!=c?(/[a-z]/.test(c)?n[a]="lowerLetter":/[A-Z]/.test(c)?n[a]="upperLetter":n[a]="symbol",s.push(a)):n[a]="space"}o.html(""),function e(a){var c,l=s.length,d=i.slice(0);if(a>l)return o.data("animated",!1),void r.callback(o);for(c=Math.max(a,0);c<l;c++)c<a+r.step?d[s[c]]=t(n[s[c]]):d[s[c]]="";o.text(d.join("")),setTimeout((function(){e(a+1)}),1e3/r.fps)}(-r.step)}))}}(jQuery),document.querySelector(".about")&&$(".about-attr .item span").each((function(e){let t=$(this).text();$(this).text(""),setTimeout((()=>{$(this).shuffleLetters({text:t,stepDelay:30,timeOffset:50})}),300*e)})),ScrollTrigger.config({limitCallbacks:!0,ignoreMobileResize:!0,autoRefreshEvents:"visibilitychange,DOMContentLoaded,load"});const lenis=new Lenis({autoRaf:!0,lerp:.1,smoothTouch:!1});let isDesktop=$(window).width()>780;function raf(e){lenis.raf(e),ScrollTrigger.update(),requestAnimationFrame(raf)}requestAnimationFrame(raf);let resizeTimeout,heightFooter=document.querySelector(".footer").clientHeight;function updateMarqueeAnimation(){const e=document.getElementById("marqueeContainer"),t=document.querySelectorAll(".showreel-partners-stroke");if(!e||0===t.length)return;const o=t[0].scrollWidth,r=e.parentElement.offsetWidth,i=-(o+(parseFloat(getComputedStyle(e).gap)||0))/r*100;let n=document.getElementById("dynamic-marquee");n||(n=document.createElement("style"),n.id="dynamic-marquuee",document.head.appendChild(n)),n.innerHTML=`\n        @keyframes animPartners {\n            0% { \n                transform: translateX(0);\n                opacity: 1;\n            }\n            95% {\n                opacity: 1;\n            }\n            100% { \n                transform: translateX(${i}%);\n                opacity: 1;\n            }\n        }\n        \n        .stroke {\n            animation-fill-mode: both;\n        }\n    `,e.style.animation="none",setTimeout((()=>{e.style.animation=""}),10)}function debouncedUpdate(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout(updateMarqueeAnimation,250)}if($("body").css({"padding-bottom":heightFooter}),lenis.raf(0),$(".works__body-information-choose button").on("click",(function(){let e=$(this).index();$(this).addClass("current"),$(".works__body-information-choose button").not(this).removeClass("current"),$(".works-frame-sction").each((function(t){$(this).index()==e?$(this).addClass("current"):$(this).removeClass("current")})),scrollTrigger.update()})),document.getElementById("marqueeContainer")?.addEventListener("animationiteration",(function(){this.style.opacity="1"})),document.addEventListener("DOMContentLoaded",(function(){setTimeout(updateMarqueeAnimation,1e3),updateMarqueeAnimation()})),window.addEventListener("resize",debouncedUpdate),document.querySelector(".celebrities")){new Splide(".celebrities-splide",{type:"loop",perMove:1,pagination:!1,arrows:!1,autoplay:!0,interval:3e3,pauseOnHover:!1}).mount()}isDesktop?($(".header-menu-open").on("click",(function(e){$(".header__menu").addClass("opened")})),$(".navigation-close").on("click",(function(e){$(".header__menu").removeClass("opened")}))):$(".header-menu-open").on("click",(function(e){$(".header__menu").toggleClass("opened")}));let lastScrollTop=0,isScrollingDown=!1;const scrollThreshold=5,activationThreshold=50;if(lenis.on("scroll",(({scroll:e})=>{ScrollTrigger.update(),currentScroll=e;const t=document.querySelector(".header");currentScroll>=2e3&&document.querySelector(".showreel")&&isDesktop?$(".footer").css({bottom:0}):currentScroll<2e3&&document.querySelector(".showreel")&&isDesktop&&$(".footer").css({bottom:"-100%"}),Math.abs(currentScroll-lastScrollTop)>5&&(isScrollingDown=currentScroll>lastScrollTop,lastScrollTop=currentScroll),isScrollingDown&&currentScroll>50?t.classList.add("back"):t.classList.remove("back")})),document.querySelector(".team-splide")){var splide=new Splide(".team-splide",{type:"loop",perPage:4,perMove:1,pagination:!1});splide.mount()}let AnimItems=document.querySelectorAll(".transform-item");gsap.set(document.querySelectorAll(".transform-item img"),{yPercent:-10}),gsap.utils.toArray(AnimItems).forEach(((e,t)=>{let o=e.querySelector("img");o&&gsap.to(o,{yPercent:10,duration:1,ease:"expo.InOut",scrollTrigger:{trigger:e,start:"top bottom",end:"+=200%",scrub:!0}})}));const itemTweens={};$(".project-filter-main button").on("click",(function(e){let t=$(this).index();$(this).addClass("current").siblings().removeClass("current"),$(".project-filter-soft .item").each((function(e){const o=$(this),r=o.index(),i=o.find("button");itemTweens[r]&&itemTweens[r].kill(),r===t?(o.addClass("current"),itemTweens[r]=gsap.to(i,{opacity:.6,duration:.6,stagger:.2,ease:"sine.out",overwrite:"auto",onComplete:function(){i.first().addClass("current")}})):(o.removeClass("current"),i.removeClass("current"),gsap.set(i,{opacity:0}))}))})),$(".project-filter-soft button").on("click",(function(e){$(this).toggleClass("current")}));let ButtonsItem=document.querySelectorAll(".project-filter-soft .item");gsap.utils.toArray(ButtonsItem).forEach(((e,t)=>{let o=e.querySelectorAll("button");0!=t&&gsap.set(o,{opacity:0})})),$(".list-item").on("click",(function(e){$(this).hasClass("current")?($(this).next(".list-item").addClass("current"),$(this).removeClass("current"),0==$(this).next(".list-item").length&&($(this).removeClass("current"),$(".list-item").first().addClass("current"))):($(this).addClass("current"),$(".list-item").not(this).removeClass("current"))})),$(window).on("load",(function(e){lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0)}));let orderWindow=document.querySelector(".order");$(".order-open").on("click",(function(e){$(".order").fadeIn(300)})),$(".close-order").on("click",(function(e){$(".order").fadeOut(300)})),document.addEventListener("DOMContentLoaded",(function(){const e="ontouchstart"in window||navigator.maxTouchPoints>0,t=document.querySelectorAll(".work, .services-frame-item, .project-wrap .item, .our-services-frame .item");function o(e){return new Promise(((t,o)=>{const r=()=>{try{const r=document.createElement("canvas");r.width=e.videoWidth,r.height=e.videoHeight;r.getContext("2d").drawImage(e,0,0,r.width,r.height),r.toBlob((r=>{if(!r)return void o("Не удалось создать Blob из canvas");const i=URL.createObjectURL(r);e.setAttribute("poster",i),t(i)}),"image/jpeg",.8)}catch(e){o(e)}};e.readyState>=2?r():e.addEventListener("loadeddata",r,{once:!0})}))}if(t.forEach((t=>{const r=t.querySelectorAll(".preview-video, .services-video");if(!r.length)return;let i=r[0];r.forEach(((e,t)=>{0===t?e.classList.add("show-video"):e.classList.remove("show-video"),e.pause(),e.currentTime=0}));e||(r.forEach((e=>{const t=e.querySelector("source");t&&t.dataset.src&&!e.src&&(t.src=t.dataset.src,e.load(),o(e))})),t.addEventListener("mouseenter",(()=>{const e=t.querySelector(".preview-video.show-video, .services-video.show-video")||r[0];var o;o=e,i&&i!==o&&(i.pause(),i.currentTime=0,i.classList.remove("show-video")),o.muted=!0,o.currentTime=0,o.play().catch((()=>{})),o.classList.add("show-video"),t.setAttribute("data-video-playing","true"),i=o})),t.addEventListener("mouseleave",(()=>{var e;i&&((e=i).pause(),e.currentTime=0,e.classList.remove("show-video"),t.setAttribute("data-video-playing","false"))})))})),e){const e=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const r=t.target;r.querySelectorAll(".preview-video, .services-video").forEach((e=>{const t=e.querySelector("source");t&&t.dataset.src&&!e.src&&(t.src=t.dataset.src,e.load(),o(e))})),e.unobserve(r)}}))}),{rootMargin:"300px 0px",threshold:0});t.forEach((t=>e.observe(t)));const r=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.target,o=t.querySelector(".preview-video.show-video, .services-video.show-video");o&&(e.isIntersecting?(o.muted=!0,o.currentTime=0,o.play().catch((()=>{})),t.setAttribute("data-video-playing","true")):(o.pause(),o.currentTime=0,t.setAttribute("data-video-playing","false")))}))}),{threshold:.5});t.forEach((e=>r.observe(e)))}$(".information-tags-tag").on("click",(function(){const e=$(this).index();$(this).addClass("current").siblings().removeClass("current");$(this).closest(".services-frame-item").find(".wrap-services-video video").each((function(t){const r=this,i=$(r).find("source");t===e?($(r).addClass("show-video"),!r.src&&i.data("src")&&(i.attr("src",i.data("src")),r.load(),o(r)),r.muted=!0,r.currentTime=0,r.play().catch((()=>{}))):(r.pause(),r.currentTime=0,$(r).removeClass("show-video"))}))}))}));let isPriorityVideoLoaded=!1;if(document.querySelector(".preloader")){function isMobileDevice(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function tryStartAnimation(){isPriorityVideoLoaded&&runPreloaderAnimation()}function checkPreloaderLoad(){const e=document.querySelector(".showreel__body-video");document.querySelector(".about-parallax video");let t=!1;if(setTimeout((()=>{t=!0,isPriorityVideoLoaded||(console.warn("Assets loading timeout, starting animation anyway"),t&&(isPriorityVideoLoaded=!0,tryStartAnimation()))}),5e3),e)if(4===e.readyState)isPriorityVideoLoaded=!0,tryStartAnimation();else{try{e.load()}catch(e){}const t=()=>{isPriorityVideoLoaded=!0,tryStartAnimation(),e.removeEventListener("loadeddata",t),e.removeEventListener("error",t)};e.addEventListener("loadeddata",t),e.addEventListener("error",t),isMobileDevice()&&0===e.readyState&&setTimeout((()=>{isPriorityVideoLoaded||(console.warn("Priority video not loading on mobile, continuing"),isPriorityVideoLoaded=!0,tryStartAnimation())}),2e3)}else isPriorityVideoLoaded=!0,tryStartAnimation()}let e=isDesktop?600:300;function runPreloaderAnimation(){const t=gsap.timeline({defaults:{ease:"power2.inOut"}});t.to(".text-h",{rotateZ:360,duration:1,yoyo:!0,transformOrigin:"50% 50%"},"-=0.4"),t.from(".second-words span",{opacity:0,y:40,stagger:.15,duration:.3,onStart:()=>{$(".second-words").animate({width:`${e}rem`},500)}},"-=0.2"),t.to(".preloader",{opacity:0,duration:.8,delay:.5,onComplete:()=>document.querySelector(".preloader").style.display="none"})}checkPreloaderLoad()}let showreel=document.querySelector(".showreel__body-wrap"),showreelVideo=document.querySelector(".showreel__body-video"),body=document.querySelector("body");showreel&&isDesktop&&($(".footer").css({bottom:"-100%"}),gsap.to(body,{background:"#242323",scrollTrigger:{trigger:showreel,scrub:!0,start:"top +=30%",end:"+=30%"}}),gsap.to(showreelVideo,{yPercent:-27,scale:.85,ease:"power1",duration:1,scrollTrigger:{trigger:showreel,scrub:!0,start:"top +=30%",end:"+=40%"}}),gsap.to(body,{scrollTrigger:{trigger:showreel,scrub:!0,start:"top +=30%",end:"+=200%",pin:!0,pinSpacer:!1}})),$(".accordion").on("click",(function(e){$(this).toggleClass("open")}));