let scrollTrigger;const lenis=new Lenis({autoRaf:!0,lerp:.1});let resizeTimeout,isDesktop=$(window).width()>780,heightFooter=document.querySelector(".footer").clientHeight;function updateMarqueeAnimation(){const e=document.getElementById("marqueeContainer"),t=document.querySelectorAll(".showreel-partners-stroke");if(!e||0===t.length)return;const o=t[0].scrollWidth,r=e.parentElement.offsetWidth,n=-(o+(parseFloat(getComputedStyle(e).gap)||0))/r*100;let i=document.getElementById("dynamic-marquee");i||(i=document.createElement("style"),i.id="dynamic-marquuee",document.head.appendChild(i)),i.innerHTML=`\n        @keyframes animPartners {\n            0% { \n                transform: translateX(0);\n                opacity: 1;\n            }\n            95% {\n                opacity: 1;\n            }\n            100% { \n                transform: translateX(${n}%);\n                opacity: 1;\n            }\n        }\n        \n        .stroke {\n            animation-fill-mode: both;\n        }\n    `,e.style.animation="none",setTimeout((()=>{e.style.animation=""}),10)}function debouncedUpdate(){clearTimeout(resizeTimeout),resizeTimeout=setTimeout(updateMarqueeAnimation,250)}if($("body").css({"padding-bottom":heightFooter}),lenis.raf(0),$(".works__body-information-choose button").on("click",(function(){let e=$(this).index();$(this).addClass("current"),$(".works__body-information-choose button").not(this).removeClass("current"),$(".works-frame-sction").each((function(t){$(this).index()==e?$(this).addClass("current"):$(this).removeClass("current")})),scrollTrigger.update()})),document.getElementById("marqueeContainer")?.addEventListener("animationiteration",(function(){this.style.opacity="1"})),document.addEventListener("DOMContentLoaded",(function(){setTimeout(updateMarqueeAnimation,1e3),updateMarqueeAnimation()})),window.addEventListener("resize",debouncedUpdate),isDesktop&&(gsap.set(".showreel__body-video",{yPercent:-50,scale:.5}),gsap.to(".showreel__body-video",{yPercent:0,scale:1,ease:"power1",scrollTrigger:{trigger:".showreel",scrub:!0,start:"top bottom",end:"bottom bottom"}})),document.querySelector(".celebrities")){let e=document.querySelectorAll(".frame-celebritie"),t=document.querySelector(".celebrities__body-frame");document.querySelector(".celebrities__body");const o=parseFloat(getComputedStyle(t).gap)||0;let r=isDesktop?100:24,n=e.length*e[0].clientWidth+(e.length-1)*o+r-t.clientWidth;gsap.to(t,{x:-n,ease:"power1",scrollTrigger:{trigger:".celebrities",scrub:!0,start:"top top",end:`+=${60*e.length}%`,pin:!0}})}$(".header-menu-open").on("click",(function(e){$(".header__menu").addClass("opened")})),$(".navigation-close").on("click",(function(e){$(".header__menu").removeClass("opened")}));let lastScrollTop=0,isScrollingDown=!1;const scrollThreshold=5,activationThreshold=50;if(lenis.on("scroll",(({scroll:e})=>{ScrollTrigger.update(),currentScroll=e;const t=document.querySelector(".header");e>=1e3?$(".footer").css({position:"fixed"}):$(".footer").css({position:"absolute"}),Math.abs(currentScroll-lastScrollTop)>5&&(isScrollingDown=currentScroll>lastScrollTop,lastScrollTop=currentScroll),isScrollingDown&&currentScroll>50?t.classList.add("back"):t.classList.remove("back")})),document.querySelector(".team-splide")){var splide=new Splide(".team-splide",{type:"loop",perPage:4,perMove:1,pagination:!1});splide.mount()}let AnimItems=document.querySelectorAll(".transform-item");gsap.set(document.querySelectorAll(".transform-item img"),{yPercent:-10}),gsap.utils.toArray(AnimItems).forEach(((e,t)=>{let o=e.querySelector("img");o&&gsap.to(o,{yPercent:10,duration:1,ease:"expo.InOut",scrollTrigger:{trigger:e,start:"top bottom",end:"+=200%",scrub:!0}})}));const itemTweens={};$(".project-filter-main button").on("click",(function(e){let t=$(this).index();$(this).addClass("current").siblings().removeClass("current"),$(".project-filter-soft .item").each((function(e){const o=$(this),r=o.index(),n=o.find("button");itemTweens[r]&&itemTweens[r].kill(),r===t?(o.addClass("current"),itemTweens[r]=gsap.to(n,{opacity:.6,duration:.6,stagger:.2,ease:"sine.out",overwrite:"auto",onComplete:function(){n.first().addClass("current")}}),scrollTrigger.update()):(o.removeClass("current"),n.removeClass("current"),gsap.set(n,{opacity:0}))}))})),$(".project-filter-soft button").on("click",(function(e){$(this).toggleClass("current")}));let ButtonsItem=document.querySelectorAll(".project-filter-soft .item");gsap.utils.toArray(ButtonsItem).forEach(((e,t)=>{let o=e.querySelectorAll("button");0!=t&&gsap.set(o,{opacity:0})})),$(".list-item").on("click",(function(e){$(this).hasClass("current")?($(this).next(".list-item").addClass("current"),$(this).removeClass("current"),0==$(this).next(".list-item").length&&($(this).removeClass("current"),$(".list-item").first().addClass("current"))):($(this).addClass("current"),$(".list-item").not(this).removeClass("current"))})),$(window).on("load",(function(e){lenis.scrollTo(0),lenis.emit(),lenis.resize(),lenis.raf(0)}));let orderWindow=document.querySelector(".order");function preloadVideos(){document.querySelectorAll(".preview-video").forEach((e=>{e.preload="metadata"}))}$(".order-open").on("click",(function(e){$(".order").fadeIn(300)})),$(".close-order").on("click",(function(e){$(".order").fadeOut(300)})),window.addEventListener("load",preloadVideos),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".work, .services-frame-item, .project-wrap .item, .our-services-frame .item").forEach((e=>{const t=e.querySelector(".preview-video")||e.querySelector(".services-video");e.querySelector(".preview-image");e.addEventListener("mouseenter",(function(){t&&(t.currentTime=0,t.play().catch((e=>{console.log("Автовоспроизведение заблокировано:",e)})),e.setAttribute("data-video-playing","true"))})),e.addEventListener("mouseleave",(function(){t&&(t.pause(),t.currentTime=0,e.setAttribute("data-video-playing","false"))})),t&&(t.addEventListener("loadedmetadata",(function(){t.muted=!0})),t.addEventListener("play",(function(){e.setAttribute("data-video-playing","true")})))}))}));